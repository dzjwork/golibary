package main

import (
	"encoding/hex"
	"fmt"
	"golibary/logrus"
	"golibary/serial"
	"strconv"
	"strings"
	"sync"
	"time"
)

func main() {
	//var waitCount sync.WaitGroup
	//c := &serial.Config{Name: "COM4", Baud: 9600}
	//
	//fd, err := serial.OpenPort(c)
	//
	//if err != nil {
	//	fmt.Println("串口打开失败")
	//} else {
	//	fmt.Println("成功打开串口", fd)
	//}
	//
	//waitCount.Add(2)

	logrus.Print("this", "is", "error")
	// go ReadData(fd, &waitCount)
	// StartzMulti(fd, &waitCount)

	test()
	// pseqByte, _ := strconv.ParseInt("0000000000011EC18B7AFD"[16:18], 16, 48)
	// fmt.Println(pseqByte, pseqByte&0x3F)
	// data := map[string]int{}

	// var count int = 0
	// for _, v := range data {
	// 	count += v
	// }
	// fmt.Println(count)

	// fmt.Println(15*1000 - 12912)
	// fmt.Println((15*1000 - 12912) * 100 / (15 * 1000))
	// waitCount.Wait()

}

// 打印串口读取到的数据
func ReadData(fd *serial.Port, waitCount *sync.WaitGroup) {
	data := make([]byte, 10)
	var res string = ""
	var pre byte = 0
	for {
		fd.Read(data)
		if pre == 13 && data[0] == 10 {

			// 区分指令
			dataInfo := strings.Split(res, "=")
			command := dataInfo[0]
			// 处理AT+MDAT指令
			if strings.EqualFold(command, "AT+MDAT") {
				data := strings.Split(dataInfo[1], ",")

				parseData := data[1]
				sid := parseData[:12]
				pseqByte, _ := strconv.ParseInt(parseData[16:18], 16, 48)

				rwLock.Lock()

				var newPseqByte int
				// 串口收到同一个传感器ACK缓存，否则清除缓存重新开始统计ACK
				if strings.EqualFold(sid, sensorID) {
					newPseqByte = int(pseqByte & 0x3F)
					sensorMap.Store(newPseqByte, true)
				}

				rwLock.Unlock()
				fmt.Println(time.Now(), ": >>>>>>>>>>>>>>>>>>>>", res, sensorID, sid, newPseqByte)
			} else if command == "+MSTAT" {
				data := strings.Split(dataInfo[1], ",")
				status := data[0]
				if status == "1" {
					rwLock.Lock()
					isSuccessMesh = true
					rwLock.Unlock()
				}
			} else {
				fmt.Println(time.Now(), ": ", res)
			}

			res = ""
		} else {
			pre = data[0]
			res = res + string(data[0])
		}
	}
}

// 计算校验和
func SplitByLength(s string, length int) string {
	runes := []rune(s) // 将字符串转换为rune切片，以便正确处理Unicode字符
	var parts int32 = 0
	for i := 0; i < len(runes); i += length {
		end := i + length
		if end > len(runes) {
			end = len(runes) // 确保不会超出字符串的末尾
		}
		it, _ := strconv.ParseInt(string(runes[i:end]), 16, 32)
		parts += int32(it)
	}
	return strconv.Itoa(int(parts))
}

func StrAligned(str string, length int, fill string, isPrefix bool) string {
	var strLength int = len([]rune(str))
	if strLength < length {
		diff := length - strLength
		if isPrefix {
			return strings.Repeat(fill, diff) + str
		}
		return str + strings.Repeat(fill, diff)
	}
	return str
}

func GetStrID(id string) string {
	var newID, _ = strconv.ParseInt(id, 16, 48)
	ID := strconv.FormatInt(newID+1, 16)
	return StrAligned(ID, 12, "0", true)
}

// 修改信道
func SetChannel(fd *serial.Port, channel string) {
	len, err := fd.Write([]byte("AT+MCFG=60000,1400," + channel + ",,\r\n"))
	if err != nil {
		fmt.Println(">> 信道修改失败", err)
	} else {
		fmt.Println(">> 信道修改成功", len)
	}
}

// 发送组网包
func Mesh(fd *serial.Port) {
	fd.Write([]byte("AT+MSTAT?\r\n"))
}

// 串口发送数据
func WriteData(fd *serial.Port, k int, v string, ID string) {
	sendData := "AT+MDAT=" + "1," + v + crc16Modbus(v) + "\r\n"
	fd.Write([]byte(sendData))
	fmt.Println(time.Now(), ID, "成功发送第", k, "包")
}

func Mread(fd *serial.Port) {
	sendData := "AT+MDAT=0,0\r\n"
	fd.Write([]byte(sendData))
}

// 重启模组
func Reset(fd *serial.Port) {
	start, err := fd.Write([]byte("AT+RST=0\r\n"))
	if err != nil {
		fmt.Println("模组重启失败", err)
	} else {
		fmt.Println("模组重启成功", start)
	}
}

var sensorID string = ""

var sensorMap sync.Map

var rwLock sync.RWMutex

var isSuccessMesh bool = false

// 多包测试
func StartzMulti(fd *serial.Port, waitCount *sync.WaitGroup) {
	var ID string = "000000000000"
	var startTime int64
	for range 1000 {
		startTime = time.Now().UnixNano() / int64(time.Millisecond)
		ID = GetStrID(ID)
		rwLock.Lock()
		sensorID = ID
		rwLock.Unlock()

		var data []string = []string{
			// 高频15包（英瑞奇）
			// ID + "184101F3039A4150384800000032000000000044420080274400008C4300008D4300008D430000924300008D4300008E4300008E4300808D430000484200808D430080904300808F4300808F430000904300009043000090430080904300809143000091430000924300004842000048420000484200004842000048420000484200004842000048420000444200004442000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000044420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004442000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004442000048420000484200004842000048420000484200004C42000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004C4200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000044420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048",
			// ID + "188102F30342000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000444200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000444200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004C4200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004C420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004C4200004C4200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004C42000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000",
			// ID + "188103F3034842000048420000484200004842000048420000484200004C4200004842000048420000484200004C42000048420000484200004842000048420000484200004C42000048420000484200004842000048420000484200004C420000484200004842000048420000484200004C4200004C4200004C420000484200004C4200004C420000484200004842000048420000484200004C420000484200004C42000048420000484200004842000048420000484200004C420000484200004C42000048420000484200004C4200004842000048420000484200004C4200004C4200004842000048420000484200004C420000484200004C420000484200004842000048420000484200004842000048420000484200004842000048420000484200004C4200004C42000048420000484200004C4200004C420000484200004C42000048420000484200004C42000048420000484200004C42000048420000484200004C4200004C42000048420000484200004842000048420000484200004842000048420000484200004C4200004C420000484200004C4200004C4200004C420000484200004C4200004C4200004C420000484200004842000048420000484200004C4200004C420000484200004C42000048420000484200004C42000048420000484200004C4200004C4200004C420000484200004C42000048420000484200004C420000484200004C420000484200004C4200004842000048420000484200004842000048420000484200004C42000048420000484200004C42000048420000484200004C4200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004842000048420000484200004C4200004C4200004C4200004C4200004842000048420000484200004C42000048420000484200004C4200004842000048420000484200004C420000484200004C420000484200004C420000484200004C420000484200004842000048420000484200004842000048420000484200004C42000048420000484200004C42000048420000484200004C4200004C4200004C42000048420000484200004842000048420000484200004C420000484200004C420000484200004C4200004C420000484200004C4200004C4200004C4200004C4200004842000048420000484200004C420000484200004C42000048420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C420000484200004C4200004842000048420000484200004C42000048420000484200004C42000048420000484200004842000048420000484200004C420000484200004C42000048420000484200004C4200004C420000484200",
			// ID + "188104F303004C4200004C4200004C4200004C4200004C4200004C4200004842000048420000484200004C4200004C4200004C4200004C420000484200004C4200004C420000484200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C42000048420000484200004C420000484200004842000048420000484200004C4200004C4200004C42000048420000484200004C420000484200004C420000484200004C4200004C420000484200004C42000048420000484200004C4200004C4200004C420000484200004C420000484200004C4200004C4200004C4200004C420000484200004C420000484200004C4200004C420000484200004C420000484200004C4200004C420000484200004C4200004C420000484200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C42000048420000484200004C4200004842000048420000484200004C4200004C4200004C42000048420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C42000048420000484200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C42000048420000484200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C42",
			// ID + "188105F30300004C4200004C4200004C4200004C420000484200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C42000048420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C",
			// ID + "188106F3034200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000",
			// ID + "188107F3034C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000504200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000274400C0264400",
			// ID + "188108F303802644008026440080264400002644000026440040264400C025440000264400802544004025440080254400402544004025440080254400002544004025440040254400402544008025440040254400802544008027440000274400C0264400C026440080264400C026440000274400C0264400C0264400009C4200004C4200C02444000025440000254400C024440080244400402444008024440040244400402444004024440000244400004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C42",
			// ID + "188109F30300004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C",
			// ID + "18810AF3034200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C420000",
			// ID + "18810BF3034C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000504200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200",
			// ID + "18810CF303004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C42",
			// ID + "18810DF30300004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C",
			// ID + "18810EF3034200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000",
			// ID + "18C10F0A014C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C420000484200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C4200004C42000078430000784300007B4300007B4300007C4300007B4300007D4300007B4300007C4300007C4300007C4300007B4300007B4300007D4300007D4300007A430000794300007D430000794300007C4300007F4300007C4300007A4300007B4300007A4300007A4300007A43",
			// 高频7包
			// ID + "280C00142E4640418156059A0194115A000000320000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			// ID + "1881824605000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			// ID + "1881834605000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			// ID + "1881844605000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			// ID + "1881854605000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			// ID + "1881864605000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			// ID + "18C1878403000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			// 高频14包（任珏）
			ID + "280C00142E5B404181B3029A0194115A000000320000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			ID + "188182A302000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			ID + "188183A302000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			ID + "188184A302000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			ID + "188185A302000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			ID + "188186A302000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			ID + "188187A302000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			ID + "188188A302000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			ID + "188189A302000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			ID + "18818AA302000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			ID + "18818BA302000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			ID + "18818CA302000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			ID + "18818DA302000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
			ID + "18C18EE100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
		}

		// 初始化缓存
		sensorMap.Store(1, false)
		sensorMap.Store(2, false)
		sensorMap.Store(3, false)
		sensorMap.Store(4, false)
		sensorMap.Store(5, false)
		sensorMap.Store(6, false)
		sensorMap.Store(7, false)
		sensorMap.Store(8, false)
		sensorMap.Store(9, false)
		sensorMap.Store(10, false)
		sensorMap.Store(11, false)
		sensorMap.Store(12, false)
		sensorMap.Store(13, false)
		sensorMap.Store(14, false)

		// 1、 改ID
		updateID, err := fd.Write([]byte("AT+MID=" + ID + "\r\n"))
		if err != nil {
			fmt.Println("修改ID失败", err)
		} else {
			fmt.Println("修改ID成功", updateID)
		}
		time.Sleep(500 * time.Millisecond)

		// 2、 重启模组
		Reset(fd)
		time.Sleep(500 * time.Millisecond)

		// 3、 持续查看组网状态，直到组网成功
		for {
			rwLock.Lock()
			if isSuccessMesh {
				rwLock.Unlock()
				break
			} else {
				rwLock.Unlock()
				Mesh(fd)
			}
			time.Sleep(1000 * time.Millisecond)
		}

		// 4、 发送数据包
		for k, v := range data {
			WriteData(fd, k, v, ID)
			time.Sleep(1000 * time.Millisecond)
		}

		// 5、 等待ACK
		time.Sleep(10000 * time.Millisecond)

		// 6、 补包，有3次补救机会，每次间隔3秒
		for i := range 2 {
			if 1 == 1 {
				break
			}
			rwLock.Lock()
			var isSendAll bool = true

			for j := range 13 {
				value, ok := sensorMap.Load(j)
				if ok {
					value := value.(bool)
					fmt.Println(i, j, value)
					if !value {
						isSendAll = false
						WriteData(fd, j+1, data[j], ID)
						time.Sleep(1000 * time.Millisecond)
					}
				}
			}

			rwLock.Unlock()
			if isSendAll {
				break
			}
			time.Sleep(3000 * time.Millisecond)
		}

		// 7、 清空缓存设备信息
		rwLock.Lock()
		sensorID = ""
		sensorMap.Clear()
		isSuccessMesh = false
		rwLock.Unlock()

		// 8、 计算耗时，进入下一次
		var endTime int64 = time.Now().UnixNano() / int64(time.Millisecond)
		var diffTime int64 = endTime - startTime
		fmt.Println(time.Now(), ": ", ID, "--成功上报数据--耗时--", diffTime, "ms")
	}
	waitCount.Done()
}

// 单包测试
func Start(fd *serial.Port, waitCount *sync.WaitGroup) {
	var ID string = "000000000000"
	var startTime int64
	for index := range 1000 {
		startTime = time.Now().UnixNano() / int64(time.Millisecond)
		if index < 10 {
			ID = "00000000000" + strconv.Itoa(index)
		} else if index < 100 {
			ID = "0000000000" + strconv.Itoa(index)
		} else if index < 1000 {
			ID = "000000000" + strconv.Itoa(index)
		} else if index < 10000 {
			ID = "00000000" + strconv.Itoa(index)
		}
		if 1 == 2 {
			ID = "EFCD08200801"
		}
		updateID, err := fd.Write([]byte("AT+MID=" + ID + "\r\n"))

		if err != nil {
			fmt.Println("修改ID失败", err)
			fmt.Println("修改ID成功", updateID)
		}

		time.Sleep(50 * time.Millisecond)

		// 一次是组网
		data, err := fd.Write([]byte("AT+SDAT=38:12.3,9:65,3:3.3\r\n"))
		if err != nil {
			fmt.Println("成功发送数据", err)
			fmt.Println("数据发送失败", data)
		}

		// 一次是数据包
		time.Sleep(50 * time.Millisecond)
		fd.Write([]byte("AT+SDAT=38:12.3,9:65,3:3.3\r\n"))

		// 模组复位
		time.Sleep(50 * time.Millisecond)
		start, err := fd.Write([]byte("AT+RST=0\r\n"))
		if err != nil {
			fmt.Println("模组重启失败", err)
			fmt.Println("模组重启成功", start)
		}

		// 等待下一次
		time.Sleep(210 * time.Millisecond)
		var endTime int64 = time.Now().UnixNano() / int64(time.Millisecond)
		var diffTime int64 = endTime - startTime

		fmt.Println(ID, "--成功上报数据--耗时--", diffTime, "ms")
	}
	waitCount.Done()
}

// 函数计算给定指令字符串的CRC16校验码
func crc16Modbus(instruction string) (str string) {
	// 将指令字符串转换为字节数组
	data, err := hex.DecodeString(instruction)
	if err != nil {
		return
	}
	// 初始化CRC值为0xFFFF
	crc := uint16(0xFFFF)
	// 遍历数据字节
	for _, b := range data {
		// 将当前字节与CRC值进行异或操作
		crc ^= uint16(b)
		// 对CRC值进行8次右移操作
		for i := 0; i < 8; i++ {
			// 如果最低位为1，则进行异或运算
			if crc&0x0001 != 0 {
				crc >>= 1
				crc ^= 0xA001
			} else {
				// 如果最低位为0，则直接右移
				crc >>= 1
			}
		}
	}
	// 将计算出的CRC16值转换为字节数组
	crcBytes := make([]byte, 2)
	crcBytes[0] = byte(crc & 0xFF)
	crcBytes[1] = byte((crc >> 8) & 0xFF)
	// 将CRC16校验码转换为十六进制字符串
	res := hex.EncodeToString(crcBytes)

	return string(res[2]) + string(res[3]) + string(res[0]) + string(res[1])
}

func test() {

}
